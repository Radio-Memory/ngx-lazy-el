!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("@angular/core"),require("@angular/elements"),require("rxjs")):"function"==typeof define&&define.amd?define("@radiomemory/ngx-lazy-el-v10",["exports","@angular/common","@angular/core","@angular/elements","rxjs"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).radiomemory=e.radiomemory||{},e.radiomemory["ngx-lazy-el-v10"]={}),e.ng.common,e.ng.core,e.ng.elements,e.rxjs)}(this,function(e,t,n,o,r){"use strict";function i(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if("default"!==n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,Object.freeze(t)}var a=i(n);function c(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{s(o.next(e))}catch(e){i(e)}}function c(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((o=o.apply(e,t||[])).next())})}function s(e,t){var n,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,o&&(r=2&c[0]?o.return:c[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,c[1])).done)return r;switch(o=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,o=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){i.label=c[1];break}if(6===c[0]&&i.label<r[1]){i.label=r[1],r=c;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(c);break}r[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],o=0}finally{n=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}Object.create;function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}function u(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l(arguments[t]));return e}Object.create;"function"==typeof SuppressedError&&SuppressedError;var d=new n.InjectionToken("ngx-lazy-cmp-registry"),f=function(){function e(e,t,n){this.injector=e,this.compiler=t,this.loadedCmps=new Map,this.elementsLoading=new Map;var o=new Map;n.forEach(function(e){o.set(e.selector,e)}),this.componentsToLoad=o}return e.prototype.getComponentsToLoad=function(){return this.componentsToLoad.keys()},e.prototype.loadContainedCustomElements=function(e){var t=this,n=Array.from(this.componentsToLoad.keys()).filter(function(t){return e.find(function(e){return e.toLowerCase()===t.toLowerCase()})}),o=Array.from(this.loadedCmps.keys()).filter(function(t){return e.find(function(e){return e.toLowerCase()===t.toLowerCase()})});n.push.apply(n,u(o));var i=Promise.all(n.map(function(e){return t.loadComponent(e,!1)}));return r.from(i)},e.prototype.loadComponent=function(e,t){return void 0===t&&(t=!0),c(this,void 0,void 0,function(){var n,r,i,a=this;return s(this,function(l){if(this.elementsLoading.has(e))return[2,this.elementsLoading.get(e)];if(this.componentsToLoad.has(e))return n=this.componentsToLoad.get(e),r=n.loadChildren,i=new Promise(function(n,i){return c(a,void 0,void 0,function(){var a,c,l,u,d,f,m,p;return s(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),[4,r()];case 1:if(a=s.sent(),c=this.compiler.compileModuleSync(a),l=c.create(this.injector),u=l.instance,d=void 0,"object"==typeof u.customElementComponent){if(!(d=u.customElementComponent[e]))throw"You specified multiple component elements in module "+a+" but there was no match for tag "+e+" in "+JSON.stringify(u.customElementComponent)+". Make sure the selector in the module is aligned with the one specified in the lazy module definition."}else d=u.customElementComponent;return f=o.createCustomElement(d,{injector:this.injector}),customElements.define(e,f),[4,customElements.whenDefined(e)];case 2:return s.sent(),this.loadedCmps.set(e,a),m=t?document.createElement(e):null,n({selector:e,componentInstance:m}),this.elementsLoading.delete(e),this.componentsToLoad.delete(e),[3,4];case 3:return p=s.sent(),this.elementsLoading.delete(e),i(p),[3,4];case 4:return[2]}})})}),this.elementsLoading.set(e,i),[2,i];if(this.loadedCmps.has(e))return[2,new Promise(function(n){n({selector:e,componentInstance:t?document.createElement(e):null})})];throw new Error('Unrecognized component "'+e+'". Make sure it is registered in the component registry')})})},e}();f.ɵfac=function(e){return new(e||f)(a.ɵɵinject(a.Injector),a.ɵɵinject(a.Compiler),a.ɵɵinject(d))},f.ɵprov=a.ɵɵdefineInjectable({token:f,factory:f.ɵfac,providedIn:"root"});var m=function(){function e(e,t,o,r,i){this.elementRef=e,this.componentLoader=t,this.cd=o,this.vcr=r,this.template=i,this.loaded=new n.EventEmitter}return e.prototype.ngOnInit=function(){var e,t=this;if(!e){var n=this.template.createEmbeddedView({});e=n.rootNodes[0].children.length>0?u(n.rootNodes[0].children).map(function(e){return e.tagName.toLowerCase()}):[n.rootNodes[0].tagName.toLowerCase()]}if(!e)throw new Error("Unable to automatically determine the dynamic element selectors. Alternatively you can pass them in via the *ngxLazyEl=\"['my-lazy-el']\"");this.componentLoader.loadContainedCustomElements(e).subscribe(function(n){t.vcr.clear(),t.vcr.createEmbeddedView(t.template);var o=null;t.elementRef.nativeElement.parentElement&&(o=t.elementRef.nativeElement.parentElement.querySelector(n[0].selector)),t.notifyComponentLoaded({selector:e[0],componentInstance:o})})},e.prototype.isIvyMode=function(){return this.template._declarationTContainer},e.prototype.notifyComponentLoaded=function(e){this.loaded.emit({selector:e.selector,componentInstance:e.componentInstance})},e.prototype.ngOnDestroy=function(){console.log("lazy load destroyed")},e}();m.ɵfac=function(e){return new(e||m)(a.ɵɵdirectiveInject(a.ElementRef),a.ɵɵdirectiveInject(f),a.ɵɵdirectiveInject(a.ChangeDetectorRef),a.ɵɵdirectiveInject(a.ViewContainerRef),a.ɵɵdirectiveInject(a.TemplateRef))},m.ɵdir=a.ɵɵdefineDirective({type:m,selectors:[["","ngxLazyEl",""]],outputs:{loaded:"loaded"}});var p=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[{provide:d,useValue:t}]}},e}();p.ɵmod=a.ɵɵdefineNgModule({type:p}),p.ɵinj=a.ɵɵdefineInjector({factory:function(e){return new(e||p)},imports:[[t.CommonModule]]}),("undefined"==typeof ngJitMode||ngJitMode)&&a.ɵɵsetNgModuleScope(p,{declarations:[m],imports:[t.CommonModule],exports:[m]}),e.ComponentLoaderService=f,e.LazyLoadDirective=m,e.NgxLazyElModule=p,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=radiomemory-ngx-lazy-el-v10.umd.min.js.map